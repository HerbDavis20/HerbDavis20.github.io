{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "description": "Net migration flows with selected wealth annotations.",
  "background": "#f5f5f5",
  "title": {
    "text": "Millionaire Migration - UK Leads the World in Millionaire Exodus",
    "subtitle": "Net inflows and outflows of millionaires in 2025 ",
    "anchor": "start",
    "align": "left"
  },
  "config": {
    "title": {
      "fontSize": 18,
      "subtitleFontSize": 14
    }
  },
  "width": 500,
  "height": 500,
  "autosize": {
    "type": "pad",
    "contains": "padding"
  },

  "data": {
    "url": "https://raw.githubusercontent.com/HerbDavis20/HerbDavis20.github.io/refs/heads/main/OM%20data%20for%20charts/chart%203/widedata-chart3.csv",
    "format": { "type": "csv" }
  },

  "transform": [
    {
      "filter": {
        "field": "country",
        "oneOf": [
          "UK",
          "China",
          "India",
          "South Korea",
          "Russia",
          "Saudi Arabia",
          "Switzerland",
          "Italy",
          "USA",
          "UAE"
        ]
      }
    }
  ],

  "encoding": {
    "y": {
      "field": "country",
      "type": "nominal",
      "sort": [
        "UK",
        "China",
        "India",
        "South Korea",
        "Russia",
        "Saudi Arabia",
        "Switzerland",
        "Italy",
        "USA",
        "UAE"
      ],
      "axis": {
        "title": "",
        "domain": false,
        "ticks": false,
        "labelAngle": 0,
        "labelPadding": 4
      }
    },
    "x": {
      "field": "flows",
      "type": "quantitative",
      "scale": { "domain": [-18000, 18000] },
      "axis": {
        "title": "",
        "gridColor": {
          "condition": { "test": "datum.value === 0", "value": "black" },
          "value": "#ddd"
        }
      }
    }
  },

  "layer": [
    {
      "mark": "bar",
      "encoding": {
        "color": {
          "condition": [
            {
              "test": "datum.country === 'UK'",
              "value": "darkorange"
            },
            {
              "test": "datum.flows < 0",
              "value": "darkorange"
            }
          ],
          "value": "steelblue"
        }
      }
    },
    {
      "data": {
        "values": [
          {
            "country": "UK",
            "x": -16500,
            "label": "≈$91.8B wealth outflow"
          },
          {
            "country": "USA",
            "x": 7500,
            "label": "≈$43.7B wealth inflow"
          },
          {
            "country": "UAE",
            "x": 10500,
            "label": "≈$63B wealth inflow"
          }
        ]
      },
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "middle",
        "dx": 4,
        "fontSize": 12,
        "fontWeight": "bold"
      },
      "encoding": {
        "x":   { "field": "x",       "type": "quantitative" },
        "y":   { "field": "country", "type": "nominal" },
        "text": { "field": "label",  "type": "nominal" },
        "color": { "value": "black" }
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "bottom",
        "fontSize": 12,
        "fontWeight": "normal",
        "color": "#0000FF"
      },
      "encoding": {
        "x": { "value": -40 },
        "y": { "value": 550 },
        "text": {
          "value": "Source: The Henley Private Wealth Migration Report 2025, Data From New World Wealth"
        }
      }
    }
  ]
}
